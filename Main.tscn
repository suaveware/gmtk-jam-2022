[gd_scene load_steps=10 format=2]

[ext_resource path="res://src/Player/Player.gd" type="Script" id=1]
[ext_resource path="res://src/classes/Grid.gd" type="Script" id=2]
[ext_resource path="res://src/classes/CameraPivot.gd" type="Script" id=3]
[ext_resource path="res://Main.gd" type="Script" id=4]
[ext_resource path="res://theme.tres" type="Theme" id=5]
[ext_resource path="res://src/DiceHud/DiceHud.tscn" type="PackedScene" id=6]
[ext_resource path="res://assets/dice.obj" type="ArrayMesh" id=7]
[ext_resource path="res://default_env.tres" type="Environment" id=8]

[sub_resource type="SpatialMaterial" id=1]

[node name="Main" type="Spatial"]
script = ExtResource( 4 )
levels = [ "res://src/levels/test.tres", "res://src/levels/level1.tres", "res://src/levels/level2.tres", "res://src/levels/level3.tres", "res://src/levels/level4.tres", "res://src/levels/level5.tres", "res://src/levels/level6.tres", "res://src/levels/level8.tres", "res://src/levels/level9.tres" ]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource( 8 )

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Gui" type="Control" parent="CanvasLayer"]
anchor_right = 1.0
anchor_bottom = 1.0
theme = ExtResource( 5 )

[node name="HBoxContainer" type="HBoxContainer" parent="CanvasLayer/Gui"]
margin_left = 10.0
margin_top = 10.0
margin_right = 40.0
margin_bottom = 40.0

[node name="Label" type="Label" parent="CanvasLayer/Gui/HBoxContainer"]
margin_right = 275.0
margin_bottom = 159.0
text = "R to reset
Q, E to rotate view
W, A, S, D to roll"

[node name="DiceHud" parent="CanvasLayer/Gui" instance=ExtResource( 6 )]
player_path = NodePath("../../../Player")

[node name="Grid" type="Spatial" parent="."]
script = ExtResource( 2 )

[node name="Tween" type="Tween" parent="Grid"]

[node name="CameraPivot" type="Spatial" parent="."]
script = ExtResource( 3 )

[node name="Camera" type="Camera" parent="CameraPivot"]
transform = Transform( 0.707107, -0.353553, 0.612373, 0, 0.866026, 0.499999, -0.707107, -0.353553, 0.612373, 38.8885, 31.849, 38.8885 )
projection = 1
current = true
size = 20.0

[node name="Tween" type="Tween" parent="CameraPivot"]

[node name="Player" type="Spatial" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 )
script = ExtResource( 1 )

[node name="Tween" type="Tween" parent="Player"]

[node name="Pivot" type="Position3D" parent="Player"]

[node name="Rotator" type="Spatial" parent="Player/Pivot"]

[node name="Mesh" type="MeshInstance" parent="Player/Pivot/Rotator"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 )
mesh = ExtResource( 7 )
skeleton = NodePath("Left")
material/0 = SubResource( 1 )

[node name="Left" type="Position3D" parent="Player/Pivot/Rotator/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0, 0 )

[node name="Right" type="Position3D" parent="Player/Pivot/Rotator/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0 )

[node name="Forward" type="Position3D" parent="Player/Pivot/Rotator/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1 )

[node name="Back" type="Position3D" parent="Player/Pivot/Rotator/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1 )

[node name="Up" type="Position3D" parent="Player/Pivot/Rotator/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 )

[node name="Down" type="Position3D" parent="Player/Pivot/Rotator/Mesh"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0 )

[connection signal="game_state_changed" from="." to="Grid" method="_on_Main_game_state_changed"]
[connection signal="player_won" from="Grid" to="." method="_on_Grid_player_won"]
[connection signal="tween_all_completed" from="Grid/Tween" to="." method="_on_Tween_tween_all_completed"]
[connection signal="rotated" from="CameraPivot" to="." method="_on_CameraPivot_rotated"]
[connection signal="moved" from="Player" to="Grid" method="_on_Player_moved"]
[connection signal="tween_step" from="Player/Tween" to="Player" method="_on_Tween_tween_step"]
